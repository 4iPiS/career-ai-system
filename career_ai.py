#!/usr/bin/env python3
"""
–£–ú–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –í–´–ë–û–†–ê –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –û–ë–£–ß–ï–ù–ò–Ø
–ó–∞–ø—É—Å–∫: python career_ai.py –æ—Ç–≤–µ—Ç—ã_—Å—Ç—É–¥–µ–Ω—Ç–∞.csv
"""

import sys
import pandas as pd
import numpy as np
import tensorflow as tf
from tensorflow import keras
import joblib
import argparse
from pathlib import Path
import textwrap
import json
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

# ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================

FIELD_DATABASE = {
    'Data Science': {
        'category': '–ò–¢ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö',
        'avg_salary': 180000,
        'employment_rate': 98,
        'study_years': 4,
        'description': '–†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑',
        'human_description': '–¢—ã –±—É–¥–µ—à—å –Ω–∞—Ö–æ–¥–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö, —Å—Ç—Ä–æ–∏—Ç—å —É–º–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –ø–æ–º–æ–≥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—è–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã—Ö –∏ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –≤ IT.',
        'skills_needed': ['Python', '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', 'SQL', '–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ', '–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö'],
        'personality': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–ª–∞–¥ —É–º–∞, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º, –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ç–µ—Ä–ø–µ–Ω–∏–µ',
        'pros': ['–í—ã—Å–æ–∫–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞', '–í–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω–æ—Å—Ç—å', '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∑–∞–¥–∞—á–∏', '–†–∞–±–æ—Ç–∞ –≤ –ª—é–±–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏'],
        'cons': ['–ú–Ω–æ–≥–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏', '–ù—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É—á–∏—Ç—å—Å—è', '–°–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã'],
        'next_steps': ['–ù–∞—á–Ω–∏ —Å Python –Ω–∞ Stepik', '–ü—Ä–æ–π–¥–∏ –∫—É—Ä—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏', '–ü–æ–ø—Ä–æ–±—É–π Kaggle'],
        'universities': ['–í–®–≠', '–ú–ì–£', '–ú–ò–§–ò', '–ò–¢–ú–û'],
        'emoji': 'üìä',
        'keywords': ['–¥–∞–Ω–Ω—ã–µ', '–∞–Ω–∞–ª–∏–∑', '–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ', 'python']
    },
    
    'Computer Science': {
        'category': '–ò–¢ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ',
        'avg_salary': 170000,
        'employment_rate': 97,
        'study_years': 4,
        'description': '–û—Å–Ω–æ–≤—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
        'human_description': '–¢—ã –±—É–¥–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –Ω—É–ª—è, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –≥–ª—É–±–æ–∫–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä—ã. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ IT-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞—Å—Ç —Ç–µ–±–µ –±–∞–∑—É –¥–ª—è –ª—é–±–æ–π IT-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.',
        'skills_needed': ['–ê–ª–≥–æ—Ä–∏—Ç–º—ã', '–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö', 'C++/Java', '–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã', '–°–µ—Ç–∏'],
        'personality': '–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ, —Ç–µ—Ä–ø–µ–Ω–∏–µ, —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –ª—é–±–æ–≤—å –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á',
        'pros': ['–®–∏—Ä–æ–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏', '–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∑–Ω–∞–Ω–∏—è', '–ú–æ–∂–Ω–æ —É–π—Ç–∏ –≤ –ª—é–±—É—é IT-—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å'],
        'cons': ['–°–ª–æ–∂–Ω–∞—è —Ç–µ–æ—Ä–∏—è', '–ú–Ω–æ–≥–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –ø–æ–Ω—è—Ç–∏–π', '–¢—Ä–µ–±—É–µ—Ç —É—Å–∏–¥—á–∏–≤–æ—Å—Ç–∏'],
        'next_steps': ['–ò–∑—É—á–∏ –æ—Å–Ω–æ–≤—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤', '–ù–∞—á–Ω–∏ —Å —è–∑—ã–∫–∞ Python –∏–ª–∏ C++', '–†–µ—à–∞–π –∑–∞–¥–∞—á–∏ –Ω–∞ LeetCode'],
        'universities': ['–ú–ì–£', '–ú–ò–§–ò', '–ú–§–¢–ò', '–°–ü–±–ì–£'],
        'emoji': 'üíª',
        'keywords': ['–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '–∞–ª–≥–æ—Ä–∏—Ç–º—ã', '—Å–∏—Å—Ç–µ–º—ã', '–∫–æ–¥']
    },
    
    'Software Engineering': {
        'category': '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ü–û',
        'avg_salary': 160000,
        'employment_rate': 96,
        'study_years': 4,
        'description': '–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
        'human_description': '–¢—ã –±—É–¥–µ—à—å –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å–∞–π—Ç—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–∏–ª–ª–∏–æ–Ω—ã –ª—é–¥–µ–π. –û—Ç –º–∞–ª–µ–Ω—å–∫–∏—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–æ –æ–≥—Ä–æ–º–Ω—ã—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.',
        'skills_needed': ['Java/Python/C#', 'Git', '–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–û', '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ'],
        'personality': '–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º',
        'pros': ['–ú–Ω–æ–≥–æ –≤–∞–∫–∞–Ω—Å–∏–π', '–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞', '–ë—ã—Å—Ç—Ä—ã–π –∫–∞—Ä—å–µ—Ä–Ω—ã–π —Ä–æ—Å—Ç'],
        'cons': ['–ù–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –≤ —Å—Ç–∞—Ä—Ç–∞–ø–∞—Ö', '–ú–Ω–æ–≥–æ –ø—Ä–∞–≤–æ–∫', '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã'],
        'next_steps': ['–í—ã–±–µ—Ä–∏ —è–∑—ã–∫ (Python/Java)', '–ò–∑—É—á–∏ Git –∏ GitHub', '–°–¥–µ–ª–∞–π –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç'],
        'universities': ['–ò–¢–ú–û', '–ú–ò–†–≠–ê', '–ú–ì–¢–£ –∏–º. –ë–∞—É–º–∞–Ω–∞', '–£—Ä–§–£'],
        'emoji': '‚öôÔ∏è',
        'keywords': ['—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞', '—Å–æ—Ñ—Ç', '–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è', '–≤–µ–±']
    },
    
    'Psychology': {
        'category': '–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—É–∫–∏',
        'avg_salary': 120000,
        'employment_rate': 88,
        'study_years': 5,
        'description': '–ò–∑—É—á–µ–Ω–∏–µ –ø—Å–∏—Ö–∏–∫–∏, –ø–æ–≤–µ–¥–µ–Ω–∏—è, –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
        'human_description': '–¢—ã –±—É–¥–µ—à—å –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å –∏—Ö –ø—Ä–æ–±–ª–µ–º–∞–º–∏, –∏–∑—É—á–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –º—ã—à–ª–µ–Ω–∏–µ. –≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å –ª—é–¥–µ–π –∏ –ø–æ–º–æ–≥–∞—Ç—å –∏–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ.',
        'skills_needed': ['–≠–º–ø–∞—Ç–∏—è', '–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è', '–ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è', '–≠—Ç–∏–∫–∞'],
        'personality': '–î–æ–±—Ä–æ—Ç–∞, —Ç–µ—Ä–ø–µ–Ω–∏–µ, —É–º–µ–Ω–∏–µ —Å–ª—É—à–∞—Ç—å, —Ç–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç',
        'pros': ['–†–∞–±–æ—Ç–∞ —Å –ª—é–¥—å–º–∏', '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–º–æ–≥–∞—Ç—å', '–ò–Ω—Ç–µ—Ä–µ—Å –∫ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π –ø—Ä–∏—Ä–æ–¥–µ'],
        'cons': ['–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤—ã–≥–æ—Ä–∞–Ω–∏–µ', '–î–æ–ª–≥–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '–°–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–µ—Ä–≤—É—é —Ä–∞–±–æ—Ç—É'],
        'next_steps': ['–ü–æ—á–∏—Ç–∞–π –∫–Ω–∏–≥–∏ –ø–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏', '–ü—Ä–æ–π–¥–∏ –∫—É—Ä—Å—ã –ø–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏', '–ü–æ–≥–æ–≤–æ—Ä–∏ —Å –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–º –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º'],
        'universities': ['–ú–ì–£', '–í–®–≠', '–°–ü–±–ì–£', '–†–ì–ì–£'],
        'emoji': 'üß†',
        'keywords': ['–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è', '–ª—é–¥–∏', '–ø–æ–º–æ—â—å', '–ø–æ–≤–µ–¥–µ–Ω–∏–µ']
    },
    
    'Design': {
        'category': '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ',
        'avg_salary': 110000,
        'employment_rate': 85,
        'study_years': 4,
        'description': '–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –±—Ä–µ–Ω–¥–∏–Ω–≥',
        'human_description': '–¢—ã –±—É–¥–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ –∏ —É–¥–æ–±–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –ª–æ–≥–æ—Ç–∏–ø—ã, –∞–π–¥–µ–Ω—Ç–∏–∫—É –±—Ä–µ–Ω–¥–æ–≤. –≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –Ω–∞ —Å—Ç—ã–∫–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –≥–¥–µ —Ç–≤–æ–∏ –∏–¥–µ–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é.',
        'skills_needed': ['–ß—É–≤—Å—Ç–≤–æ —Å—Ç–∏–ª—è', 'Figma/Photoshop', '–ö–æ–º–ø–æ–∑–∏—Ü–∏—è', '–ö–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∞', '–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞'],
        'personality': '–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º, –Ω–∞—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—å, —á—É–≤—Å—Ç–≤–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ',
        'pros': ['–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞', '–í–∏–¥–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç', '–ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫', '–ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ'],
        'cons': ['–°—É–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞', '–ú–Ω–æ–≥–æ –ø—Ä–∞–≤–æ–∫ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤', '–¢—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è'],
        'next_steps': ['–û—Å–≤–æ–π Figma', '–ò–∑—É—á–∏ –æ—Å–Ω–æ–≤—ã –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∏ —Ü–≤–µ—Ç–∞', '–°–æ–∑–¥–∞–π –ø–µ—Ä–≤–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ'],
        'universities': ['–ë—Ä–∏—Ç–∞–Ω—Å–∫–∞—è –≤—ã—Å—à–∞—è —à–∫–æ–ª–∞ –¥–∏–∑–∞–π–Ω–∞', '–ü—Ä–æ—Ñ–∞–∫–∞–¥–µ–º–∏—è', '–°—Ç—Ä–æ–≥–∞–Ω–æ–≤–∫–∞', '–ù–ò–£ –í–®–≠'],
        'emoji': 'üé®',
        'keywords': ['–¥–∏–∑–∞–π–Ω', '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ', '–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã', '–≤–∏–∑—É–∞–ª']
    },
    
    'Economics': {
        'category': '–ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã',
        'avg_salary': 140000,
        'employment_rate': 92,
        'study_years': 4,
        'description': '–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–æ–≤, —Ñ–∏–Ω–∞–Ω—Å–æ–≤, —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
        'human_description': '–¢—ã –±—É–¥–µ—à—å –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä—ã–Ω–∫–∏, —Å—Ç—Ä–æ–∏—Ç—å —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã –∏ –ø–æ–º–æ–≥–∞—Ç—å –∫–æ–º–ø–∞–Ω–∏—è–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è. –≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.',
        'skills_needed': ['–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', '–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö', 'Excel', '–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä—ã–Ω–∫–æ–≤', '–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å'],
        'personality': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —É–º, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ, –∏–Ω—Ç–µ—Ä–µ—Å –∫ –±–∏–∑–Ω–µ—Å—É, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
        'pros': ['–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –∫–∞—Ä—å–µ—Ä—ã', '–í—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥', '–ü—Ä–µ—Å—Ç–∏–∂', '–†–∞–±–æ—Ç–∞ –≤ –±–∞–Ω–∫–∞—Ö –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏—è—Ö'],
        'cons': ['–í—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è', '–°—Ç—Ä–µ—Å—Å', '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è'],
        'next_steps': ['–ü—Ä–æ–π–¥–∏ –∫—É—Ä—Å –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ', '–ß–∏—Ç–∞–π –±–∏–∑–Ω–µ—Å-–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É', '–ò–∑—É—á–∏ Excel –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É'],
        'universities': ['–í–®–≠', '–ú–ì–£', '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç', '–†–≠–£ –∏–º. –ü–ª–µ—Ö–∞–Ω–æ–≤–∞'],
        'emoji': 'üìà',
        'keywords': ['—ç–∫–æ–Ω–æ–º–∏–∫–∞', '—Ñ–∏–Ω–∞–Ω—Å—ã', '–±–∏–∑–Ω–µ—Å', '–∞–Ω–∞–ª–∏–∑']
    },
    
    'Medicine': {
        'category': '–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ',
        'avg_salary': 150000,
        'employment_rate': 99,
        'study_years': 6,
        'description': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –ª–µ—á–µ–Ω–∏–µ, –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
        'human_description': '–¢—ã –±—É–¥–µ—à—å —Å–ø–∞—Å–∞—Ç—å –∂–∏–∑–Ω–∏, –ª–µ—á–∏—Ç—å –±–æ–ª–µ–∑–Ω–∏ –∏ –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ. –≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –±–ª–∞–≥–æ—Ä–æ–¥–Ω—ã—Ö –∏ –≤–∞–∂–Ω—ã—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–π, –∫–æ—Ç–æ—Ä–∞—è —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –æ—Ç–¥–∞—á–∏.',
        'skills_needed': ['–ë–∏–æ–ª–æ–≥–∏—è', '–•–∏–º–∏—è', '–ê–Ω–∞—Ç–æ–º–∏—è', '–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–≠–º–ø–∞—Ç–∏—è'],
        'personality': '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –∂–µ–ª–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞—Ç—å, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
        'pros': ['–ü–æ–º–æ—â—å –ª—é–¥—è–º', '–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å', '–£–≤–∞–∂–µ–Ω–∏–µ –≤ –æ–±—â–µ—Å—Ç–≤–µ', '–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ'],
        'cons': ['–î–æ–ª–≥–æ–µ –æ–±—É—á–µ–Ω–∏–µ', '–í—ã—Å–æ–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å', '–ù–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫', '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏'],
        'next_steps': ['–£–≥–ª—É–±–ª–µ–Ω–Ω–æ –∏–∑—É—á–∞–π –±–∏–æ–ª–æ–≥–∏—é –∏ —Ö–∏–º–∏—é', '–ü–æ–æ–±—â–∞–π—Å—è —Å –≤—Ä–∞—á–∞–º–∏', '–ü—Ä–æ–π–¥–∏ –∫—É—Ä—Å—ã –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏'],
        'universities': ['–ü–µ—Ä–≤—ã–π –ú–ì–ú–£', '–†–ù–ò–ú–£', '–°–ü–±–ì–ú–£', '–ú–ì–ú–°–£'],
        'emoji': '‚öïÔ∏è',
        'keywords': ['–º–µ–¥–∏—Ü–∏–Ω–∞', '–∑–¥–æ—Ä–æ–≤—å–µ', '–ª–µ—á–µ–Ω–∏–µ', '–≤—Ä–∞—á']
    },
    
    'Linguistics': {
        'category': '–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ –Ω–∞—É–∫–∏',
        'avg_salary': 100000,
        'employment_rate': 89,
        'study_years': 4,
        'description': '–ò–∑—É—á–µ–Ω–∏–µ —è–∑—ã–∫–æ–≤, –ø–µ—Ä–µ–≤–æ–¥, –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞',
        'human_description': '–¢—ã –±—É–¥–µ—à—å –∏–∑—É—á–∞—Ç—å, –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã —è–∑—ã–∫–∏, —Ä–∞–±–æ—Ç–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–º –∏–ª–∏ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–æ–π. –≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π —è–∑—ã–∫–æ–≤ –∏ –∫—É–ª—å—Ç—É—Ä.',
        'skills_needed': ['–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏', '–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞', '–ü–∞–º—è—Ç—å', '–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è', '–ö—É–ª—å—Ç—É—Ä–æ–ª–æ–≥–∏—è'],
        'personality': '–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º, –ª—é–±–æ–≤—å –∫ —è–∑—ã–∫–∞–º, —Ç–µ—Ä–ø–µ–Ω–∏–µ',
        'pros': ['–†–∞–±–æ—Ç–∞ —Å —è–∑—ã–∫–∞–º–∏', '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞—Ç—å', '–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∑–∞–¥–∞—á'],
        'cons': ['–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è —Å –Ω–æ—Å–∏—Ç–µ–ª—è–º–∏', '–ú–Ω–æ–≥–æ —Ä—É—Ç–∏–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã', '–¢—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏'],
        'next_steps': ['–£–≥–ª—É–±–ª–µ–Ω–Ω–æ –∏–∑—É—á–∞–π –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏', '–ß–∏—Ç–∞–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ', '–ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ–≤–æ–¥'],
        'universities': ['–ú–ì–£', '–í–®–≠', '–ú–ì–õ–£', '–°–ü–±–ì–£'],
        'emoji': 'üî§',
        'keywords': ['—è–∑—ã–∫–∏', '–ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞', '–ø–µ—Ä–µ–≤–æ–¥', '–∫—É–ª—å—Ç—É—Ä–∞']
    }
}

# ==================== –ù–ï–ô–†–û–°–ï–¢–¨ ====================

class CareerAdvisorAI:
    """–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π"""
    
    def __init__(self, model_dir='career_model'):
        self.model_dir = Path(model_dir)
        self.model = None
        self.scaler = None
        self.label_encoder = None
        self.fields_info = FIELD_DATABASE
        
    def load_model(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏"""
        if not self.model_dir.exists():
            print(f"–ü–∞–ø–∫–∞ —Å –º–æ–¥–µ–ª—å—é –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: {self.model_dir}")
            print("   –°–Ω–∞—á–∞–ª–∞ –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å: python train_model.py")
            sys.exit(1)
        
        print("–ó–∞–≥—Ä—É–∂–∞—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π...")
        
        try:
            self.model = keras.models.load_model(self.model_dir / 'career_model.h5')
            self.scaler = joblib.load(self.model_dir / 'scaler.pkl')
            self.label_encoder = joblib.load(self.model_dir / 'label_encoder.pkl')
            
            print(f"–ò–ò –∑–∞–≥—Ä—É–∂–µ–Ω! –ó–Ω–∞–µ—Ç {len(self.label_encoder.classes_)} –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π")
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}")
            print("   –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å: python train_model.py")
            sys.exit(1)
    
    def analyze_student_profile(self, csv_path):
        """–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ CSV"""
        print(f"–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø—Ä–æ—Ñ–∏–ª—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ {csv_path}")
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–≤–µ—Ç—ã
        try:
            student_data = pd.read_csv(csv_path)
            print(f"   –ù–∞–π–¥–µ–Ω–æ {len(student_data)} –æ—Ç–≤–µ—Ç–æ–≤")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
            required_cols = ['math_skill', 'programming_skill', 'communication_skill']
            missing_cols = [col for col in required_cols if col not in student_data.columns]
            
            if missing_cols:
                print(f"–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–æ–ª–æ–Ω–∫–∏: {missing_cols}")
                print("   –ò—Å–ø–æ–ª—å–∑—É—é –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}")
            sys.exit(1)
        
        # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏
        X_processed = self._prepare_student_data(student_data)
        
        # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        print("–ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å...")
        predictions = self.model.predict(X_processed, verbose=0)[0]
        
        # –¢–æ–ø-3 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        top_indices = np.argsort(predictions)[::-1][:3]
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
        recommendations = []
        for i, idx in enumerate(top_indices):
            field_name = self.label_encoder.inverse_transform([idx])[0]
            probability = predictions[idx] * 100
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
            info = self.fields_info.get(field_name, {
                'category': '–û–±—â–µ–µ',
                'avg_salary': 100000,
                'employment_rate': 85,
                'human_description': '–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ',
                'emoji': 'üéì'
            })
            
            recommendations.append({
                'rank': i + 1,
                'field': field_name,
                'emoji': info.get('emoji', 'üéì'),
                'probability': round(probability, 1),
                'match_level': self._get_match_level(probability),
                'category': info.get('category', ''),
                'avg_salary': f"{info.get('avg_salary', 0):,}‚ÇΩ",
                'employment': f"{info.get('employment_rate', 0)}%",
                'study_years': info.get('study_years', 4),
                'description': info.get('human_description', ''),
                'skills': info.get('skills_needed', []),
                'personality': info.get('personality', ''),
                'pros': info.get('pros', []),
                'cons': info.get('cons', []),
                'next_steps': info.get('next_steps', []),
                'universities': info.get('universities', []),
                'keywords': info.get('keywords', [])
            })
        
        return recommendations, student_data
    
    def _prepare_student_data(self, student_df):
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        # –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–∂–∏–¥–∞–µ—Ç –º–æ–¥–µ–ª—å
        expected_features = [
            'math_skill', 'programming_skill', 'communication_skill',
            'creativity', 'analytical_thinking', 'memory',
            'attention_to_detail', 'teamwork', 'leadership',
            'stress_tolerance', 'adaptability', 'curiosity',
            'math_interest', 'physics_interest', 'chemistry_interest',
            'biology_interest', 'it_interest', 'economics_interest',
            'humanities_interest', 'art_interest', 'sports_interest',
            'desired_salary', 'preferred_work_env', 'work_life_balance'
        ]
        
        # –°–æ–∑–¥–∞–µ–º DataFrame —Å –Ω—É–∂–Ω—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
        processed_data = {}
        
        for feature in expected_features:
            if feature in student_df.columns:
                # –ë–µ—Ä–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫
                value = student_df[feature].mean()
            else:
                # –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                defaults = {
                    'math_skill': 3.0, 'programming_skill': 3.0, 'communication_skill': 3.0,
                    'creativity': 3.0, 'analytical_thinking': 3.0, 'memory': 3.0,
                    'attention_to_detail': 3.0, 'teamwork': 3.0, 'leadership': 3.0,
                    'stress_tolerance': 3.0, 'adaptability': 3.0, 'curiosity': 3.0,
                    'math_interest': 3.0, 'physics_interest': 3.0, 'chemistry_interest': 3.0,
                    'biology_interest': 3.0, 'it_interest': 3.0, 'economics_interest': 3.0,
                    'humanities_interest': 3.0, 'art_interest': 3.0, 'sports_interest': 3.0,
                    'desired_salary': 100000, 'preferred_work_env': 2, 'work_life_balance': 3
                }
                value = defaults.get(feature, 3.0)
            
            processed_data[feature] = value
        
        # –°–æ–∑–¥–∞–µ–º DataFrame –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º
        X = pd.DataFrame([processed_data])
        X_scaled = self.scaler.transform(X)
        
        return X_scaled
    
    def _get_match_level(self, probability):
        """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è"""
        if probability >= 85:
            return "–ò–î–ï–ê–õ–¨–ù–û –ü–û–î–•–û–î–ò–¢"
        elif probability >= 70:
            return "–û–¢–õ–ò–ß–ù–û–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï"
        elif probability >= 50:
            return "–•–û–†–û–®–ò–ô –í–ê–†–ò–ê–ù–¢"
        else:
            return "–ú–û–ñ–ù–û –†–ê–°–°–ú–û–¢–†–ï–¢–¨"
    
    def display_results(self, recommendations, student_data, output_file=None):
        """–ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
        print("\n" + "="*80)
        print("–í–ê–® –ü–ï–†–°–û–ù–ê–õ–¨–ù–´–ô –ö–ê–†–¨–ï–†–ù–´–ô –ü–õ–ê–ù")
        print("="*80)
        print(f"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: {datetime.now().strftime('%d.%m.%Y %H:%M')}")
        print()
        
        # –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
        print("–í–ê–® –ü–†–û–§–ò–õ–¨:")
        print("-"*40)
        
        # –ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        if not student_data.empty:
            key_traits = []
            if 'math_skill' in student_data.columns and student_data['math_skill'].mean() >= 4:
                key_traits.append("–°–∏–ª—å–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞")
            if 'programming_skill' in student_data.columns and student_data['programming_skill'].mean() >= 4:
                key_traits.append("–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–∫–ª–∞–¥ —É–º–∞")
            if 'communication_skill' in student_data.columns and student_data['communication_skill'].mean() >= 4:
                key_traits.append("–ö–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å")
            if 'creativity' in student_data.columns and student_data['creativity'].mean() >= 4:
                key_traits.append("–¢–≤–æ—Ä—á–µ—Å–∫–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏")
            
            if key_traits:
                for trait in key_traits:
                    print(f"   {trait}")
            else:
                print("   –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å")
        
        print("\n" + "="*80)
        print("–¢–û–ü-3 –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:")
        print("="*80)
        
        output_content = []
        
        for rec in recommendations:
            print(f"\n{'*' * rec['rank']} {rec['emoji']} {rec['field']} {rec['emoji']}")
            print(f"   {rec['match_level']} ({rec['probability']}%)")
            print(f"   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {rec['category']}")
            print(f"   –°—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞: {rec['avg_salary']}")
            print(f"   –¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: {rec['employment']}")
            print(f"   –°—Ä–æ–∫ –æ–±—É—á–µ–Ω–∏—è: {rec['study_years']} –≥–æ–¥–∞")
            
            # –û–ø–∏—Å–∞–Ω–∏–µ
            print(f"\n   –û –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏:")
            for line in textwrap.wrap(rec['description'], width=70):
                print(f"      {line}")
            
            # –ù–∞–≤—ã–∫–∏
            if rec['skills']:
                print(f"\n   –ö–ª—é—á–µ–≤—ã–µ –Ω–∞–≤—ã–∫–∏:")
                skills_str = ", ".join(rec['skills'][:4])
                for line in textwrap.wrap(skills_str, width=65):
                    print(f"      {line}")
            
            # –ü–æ–¥—Ö–æ–¥–∏—Ç –µ—Å–ª–∏
            if rec['personality']:
                print(f"\n   –ü–æ–¥—Ö–æ–¥–∏—Ç –≤–∞–º, –µ—Å–ª–∏ –≤—ã:")
                for line in textwrap.wrap(rec['personality'], width=65):
                    print(f"      {line}")
            
            # –ü–ª—é—Å—ã
            if rec['pros']:
                print(f"\n   –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:")
                for pro in rec['pros'][:3]:
                    print(f"      ‚Ä¢ {pro}")
            
            # –ú–∏–Ω—É—Å—ã
            if rec['cons']:
                print(f"\n   –°–ª–æ–∂–Ω–æ—Å—Ç–∏:")
                for con in rec['cons'][:2]:
                    print(f"      ‚Ä¢ {con}")
            
            # –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏
            if rec['next_steps']:
                print(f"\n   –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏:")
                for step in rec['next_steps'][:3]:
                    print(f"      1. {step}")
            
            # –í—É–∑—ã
            if rec['universities']:
                print(f"\n   –í–µ–¥—É—â–∏–µ –≤—É–∑—ã:")
                unis = ", ".join(rec['universities'][:4])
                for line in textwrap.wrap(unis, width=65):
                    print(f"      {line}")
            
            print("\n" + "-"*80)
            
            # –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª
            output_content.append({
                '–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ': rec['field'],
                '–†–µ–π—Ç–∏–Ω–≥': rec['rank'],
                '–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ': f"{rec['probability']}%",
                '–£—Ä–æ–≤–µ–Ω—å': rec['match_level'],
                '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': rec['category'],
                '–ó–∞—Ä–ø–ª–∞—Ç–∞': rec['avg_salary'],
                '–¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ': rec['employment'],
                '–û–ø–∏—Å–∞–Ω–∏–µ': rec['description'],
                '–ù–∞–≤—ã–∫–∏': ', '.join(rec['skills'][:3]),
                '–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏': ' | '.join(rec['next_steps'][:3])
            })
        
        # –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
        print("\n–ò–¢–û–ì–û–í–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
        print("-"*40)
        
        best = recommendations[0]
        if best['probability'] >= 80:
            print(f"   –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ {best['field']}!")
            print(f"   –≠—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–¥–µ–∞–ª—å–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–µ–º—É –ø—Ä–æ—Ñ–∏–ª—é.")
            print(f"   –ù–∞—á–Ω–∏—Ç–µ —Å –ø–µ—Ä–≤—ã—Ö —à–∞–≥–æ–≤ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è!")
        elif best['probability'] >= 60:
            print(f"   –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ {best['field']} –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç,")
            print(f"   –∞ {recommendations[1]['field']} –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π.")
            print(f"   –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫—É—Ä—Å—ã –ø–æ –æ–±–æ–∏–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º.")
        else:
            print(f"   –ü—Ä–æ–π–¥–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏–ª–∏ –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å")
            print(f"   —Å –∫–∞—Ä—å–µ—Ä–Ω—ã–º –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è.")
        
        print("\n" + "="*80)
        print("–°–û–í–ï–¢: –û–±—Å—É–¥–∏—Ç–µ —ç—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏ –∏ —É—á–∏—Ç–µ–ª—è–º–∏.")
        print("      –ü–æ—Å–µ—Ç–∏—Ç–µ –¥–Ω–∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –¥–≤–µ—Ä–µ–π –≤ –≤—É–∑–∞—Ö.")
        print("      –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã.")
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª
        if output_file:
            self._save_to_file(output_content, best, output_file)
    
    def _save_to_file(self, recommendations, best_rec, filename):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª"""
        try:
            with open(filename, 'w', encoding='utf-8') as f:
                f.write("="*80 + "\n")
                f.write("–ü–ï–†–°–û–ù–ê–õ–¨–ù–´–ô –ö–ê–†–¨–ï–†–ù–´–ô –ü–õ–ê–ù - –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê\n")
                f.write("="*80 + "\n\n")
                f.write(f"–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {datetime.now().strftime('%d.%m.%Y %H:%M')}\n\n")
                
                f.write("–õ–£–ß–®–ï–ï –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï:\n")
                f.write("-"*40 + "\n")
                f.write(f"{best_rec['emoji']} {best_rec['field']}\n")
                f.write(f"–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ: {best_rec['probability']}% ({best_rec['match_level']})\n")
                f.write(f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {best_rec['category']}\n")
                f.write(f"–ó–∞—Ä–ø–ª–∞—Ç–∞: {best_rec['avg_salary']}\n")
                f.write(f"–¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: {best_rec['employment']}\n\n")
                
                f.write("–í–°–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:\n")
                f.write("-"*40 + "\n")
                
                for rec in recommendations:
                    f.write(f"\n{rec['–†–µ–π—Ç–∏–Ω–≥']}. {rec['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ']}\n")
                    f.write(f"   –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ: {rec['–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ']} ({rec['–£—Ä–æ–≤–µ–Ω—å']})\n")
                    f.write(f"   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {rec['–ö–∞—Ç–µ–≥–æ—Ä–∏—è']}\n")
                    f.write(f"   –ó–∞—Ä–ø–ª–∞—Ç–∞: {rec['–ó–∞—Ä–ø–ª–∞—Ç–∞']}\n")
                    f.write(f"   –¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: {rec['–¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ']}\n")
                    f.write(f"   –û–ø–∏—Å–∞–Ω–∏–µ: {rec['–û–ø–∏—Å–∞–Ω–∏–µ']}\n")
                    f.write(f"   –ù–∞–≤—ã–∫–∏: {rec['–ù–∞–≤—ã–∫–∏']}\n")
                    f.write(f"   –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏: {rec['–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏']}\n")
                
                f.write("\n" + "="*80 + "\n")
                f.write("–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ü–û–ú–û–©–¨:\n")
                f.write("-"*40 + "\n")
                f.write("‚Ä¢ –ü—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é —É —à–∫–æ–ª—å–Ω–æ–≥–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞\n")
                f.write("‚Ä¢ –ü–æ—Å–µ—Ç–∏—Ç–µ –≤—ã—Å—Ç–∞–≤–∫–∏ \"–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∫–∞—Ä—å–µ—Ä–∞\"\n")
                f.write("‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç–∞–ª \"–ü—Ä–æ–µ–∫—Ç–æ—Ä–∏—è\" –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏—è–º–∏\n")
                f.write("‚Ä¢ –ü–æ–æ–±—â–∞–π—Ç–µ—Å—å —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π\n\n")
                
                f.write("–£–¥–∞—á–∏ –≤ –≤—ã–±–æ—Ä–µ –±—É–¥—É—â–µ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏! üöÄ\n")
            
            print(f"\n–ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: {filename}")
            
        except Exception as e:
            print(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª: {e}")

# ==================== –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ====================

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    parser = argparse.ArgumentParser(
        description='–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog='''
–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
  python career_ai.py —Å—Ç—É–¥–µ–Ω—Ç_–∏–≤–∞–Ω.csv
  python career_ai.py –æ—Ç–≤–µ—Ç—ã.csv --output –º–æ–π_–ø–ª–∞–Ω.txt
  python career_ai.py —Ç–µ—Å—Ç.csv --top 5

–§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞ (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä):
  math_skill,programming_skill,communication_skill,creativity,analytical_thinking

–í—Å–µ–≥–æ —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç 24 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
        '''
    )
    
    parser.add_argument('csv_file', help='CSV —Ñ–∞–π–ª —Å –æ—Ç–≤–µ—Ç–∞–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞')
    parser.add_argument('--output', '-o', default='–º–æ–π_–∫–∞—Ä—å–µ—Ä–Ω—ã–π_–ø–ª–∞–Ω.txt',
                       help='–§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤')
    parser.add_argument('--top', '-t', type=int, default=3,
                       help='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3)')
    parser.add_argument('--model-dir', '-m', default='career_model',
                       help='–ü–∞–ø–∫–∞ —Å –º–æ–¥–µ–ª—å—é –ò–ò')
    
    args = parser.parse_args()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º—É
    print("="*80)
    print("CAREEAR AI - –£–ú–ù–´–ô –ü–û–ú–û–©–ù–ò–ö –í –í–´–ë–û–†–ï –ü–†–û–§–ï–°–°–ò–ò")
    print("="*80)
    print()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª
    if not Path(args.csv_file).exists():
        print(f"–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {args.csv_file}")
        sys.exit(1)
    
    # –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –ò–ò
    advisor = CareerAdvisorAI(model_dir=args.model_dir)
    advisor.load_model()
    
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞
    recommendations, student_data = advisor.analyze_student_profile(args.csv_file)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    advisor.display_results(recommendations, student_data, args.output)
    
    print("\n" + "="*80)
    print("–ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù!")
    print("   –í–∞—à–µ –±—É–¥—É—â–µ–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–µ–≥–æ–¥–Ω—è!")

if __name__ == "__main__":
    main()